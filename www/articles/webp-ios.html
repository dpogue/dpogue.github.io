<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <title itemprop="name">cordova-plugin-webp: WebP support for iOS - dpogue.ca</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="supported-color-schemes" content="light dark">
    <meta name="color-scheme" content="light dark">
    <!--[if IE ]><script src="/js/ieshim.js"></script><![endif]-->
    <style>
body {
    color-scheme: light dark;
    margin: 0;
    padding: 0;
    font: -apple-system-body;
    font-family: system-ui, sans-serif;
    background: #2d2b36;
    background-image: linear-gradient(to bottom, #2d2b36, #2d2b36, #1a1c28);
    min-height: 100%;
    min-height: 100vh;
}

header {
    display: block;
    padding-top: env(safe-area-inset-top, 0px);
    box-sizing: border-box;
    background: #a9a6ad;
    background-image: linear-gradient(to bottom, #a9a6ad, #f7ba84);
}

header svg {
    width: 100%;
    display: block;
    overflow: hidden;
}

main {
    display: block;
    box-sizing: border-box;
    width: 90%;
    width: calc(100vw - 2rem);
    width: calc(100vw - 2rem - env(safe-area-inset-left, 0px) - env(safe-area-inset-right, 0px));
    max-width: 960px;
    margin: 0 auto;
}

h1 {
    font-size: 2em;
    font-weight: 500;
    color: #f7ba84;
}

article, section {
    display: block;
    background: #cacace;
    color: #24222a;
    padding: 1em;
    padding: 1rem;
    box-shadow: 0 0 1rem rgba(0, 0, 0, 0.25);
    border-radius: 0.25rem 0.25rem 0 0;
    border: 0.5px solid rgba(255, 255, 255, 0.5);
    line-height: 1.5;
}

a {
    color: #474658;
}
    </style>
    <style media="(prefers-color-scheme: dark)">
article, section {
    color: #cacace;
    background: #24222a;
    box-shadow: 0 0 1rem rgba(0, 0, 0, 0.25);
    border-color: rgba(0, 0, 0, 0.1);
}

a {
    color: #f7ba84;
}
    </style>
    <meta name="theme-color" content="#a9a6ad">
    <meta name="description" itemprop="description" content="A Cordova plugin for automatic handling of WebP images in iOS web views.">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="canonical" itemprop="mainEntityOfPage" href="https://dpogue.ca/articles/webp-ios.html">
  </head>
  <body>
    <header>
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2828 460" preserveAspectRatio="xMidYMax meet" role="presentation">
    <title>dpogue.ca</title>
    <path role="presentation" fill="#615968" d="M902 203c26-10 51-19 66-27 14-9 17-15 20-17 2-2 4 2 7 2s7-3 13-3c5-1 10 2 16 2l16-3c5 0 11 4 18 7l23 4c8 2 14 5 20 8 5 4 8 6 14 7l23 1c10 0 20 2 26 3l13 4h13c5 0 12 2 19 4l22 6 24 3 12 3h10l23 2 32 3 27 4 19 3 14 4 25 3 25 6 28 6 26 1 30 6c13 3 32 4 50 5h49c15 1 28 4 40 6l33 5 34 1 33 3c10 2 17 3 28 2h41c16 2 32 7 43 9 10 1 15-1 22-1l26 3 29 2 40 4c17 2 35 3 57 7 22 3 48 8 65 12s27 6 37 6 20-2 45 1c78 10 155 25 230 46 50 14 112 35 174 55l226 49H902"></path>
    <path role="presentation" fill="#655764" d="M1161 460l-2-184-50-26c-23-14-58-35-90-51s-61-28-79-34c-17-7-24-7-28-8-5-1-7-3-10-5l-8-11-10-13-13-10-8-3-6 3-9 9-16 14c-5 5-7 8-10 9-3 2-6 1-9 0l-10-5c-4-1-7 0-11 2l-14 8c-4 2-5 3-7 1-3-1-6-5-8-9l-6-7-6-1-8 1-10-1c-3-1-4-3-6-7-2-3-4-9-8-12s-9-3-12-4l-8-3-4 2-6-2-5 1-10-4h-9l-7 2c-2 1-4-1-6-4l-6-6c-2-1-3 1-5 1l-4 2c-2 0-5-1-8 1-3 1-6 4-9 7l-7 10c-2 3-4 5-9 7l-43 14-152 46v270"></path>
    <path role="presentation" fill="#655764" d="M778 460V214l-69-24-32-13-45-22-38-17c-7-3-7-4-7-6-1-2-1-5-5-8-3-3-10-6-16-8-7-3-13-4-19-5h-17l-10 3-7 6h-5l-6 2-8-4c-3-3-8-8-13-10-6-3-12-4-17-5h-16l-7-3-10-8c-3-1-4-2-6-1l-7 4-9 8-12 5-22 5h-9l-6 3-7 7-11 3c-3 0-5 2-7 5l-7 12-11 11-12 7c-3 2-3 1-8 2-4 0-11 0-19 2-12 3-24 7-34 14l-8 5-14 3-16-1c-5 1-11 2-16 5l-14 7-14 15c-10 11-26 31-34 76-9 45-9 102-9 171"></path>
    <path role="presentation" fill="#474658" d="M1161 460l-2-184c-33-16-65-32-91-42s-45-14-70-18c-26-4-58-7-85-9l-68-5c-18-3-29-6-39-9-9-3-17-7-29-8-30-3-60-1-89 5l-41 9c-13 2-25 1-37 0s-25-3-39-1c-13 2-28 8-44 15-39 16-78 30-119 40l1 207"></path>
    <path role="presentation" fill="#4c4859" d="M605 460V273c-21-7-42-13-59-21-17-7-30-16-43-24-14-8-27-16-44-22-31-12-63-17-96-16l-21 1-23-4c-9-1-20-3-27-2-7 0-12 2-17 4l-21 2h-27c-22 1-44 6-65 13-9 3-14 6-22 6-9 1-22-1-31-1-10 0-16 2-29 10-12 8-31 21-41 30-10 8-12 12-15 17l-12 16-12 9v169"></path>
    <path role="presentation" fill="#2d2b36" d="M0 460v-69l89-44c30-14 59-26 88-33 29-6 57-7 85-8 56-2 112-11 165-28 21-7 29-11 41-18 11-6 25-14 36-18 10-4 16-2 22-2h16c7-1 16-3 26-2l33 6c11 2 19 2 28 1s17-3 26-3c8-1 16 1 25 1l25 1c8 0 17 3 23 4 5 1 8 1 17-2l38-11c19-6 39-6 57 1l23 10c5 2 6 4 9 4h10c5 1 12 3 17 7l18 10c8 3 19 4 30 8l28 12c7 3 10 2 21 0l43-10c15-3 27-6 42-7 15-2 32-2 54 2 22 3 49 9 84 16l105 20c29 4 47 4 76 5 28 2 67 4 123 5l223 5c92 3 203 10 386 29 184 19 442 52 699 84v24"></path>
    <path role="presentation" fill="none" stroke="#2d2b36" stroke-width="6" stroke-linecap="round" d="m 2114.4321,56.96991 c -0.4226,0 -0.8451,0 2.9584,8.875197 4.015,9.086511 12.2562,27.470852 17.7505,42.685473 5.4941,15.42594 8.4525,28.10479 7.8185,38.03656 -0.6339,10.14308 -4.8602,17.53909 -12.2561,21.34274 -7.3961,3.80365 -18.1731,3.80365 -24.5125,-0.42263 -6.3394,-4.22628 -8.4526,-12.25622 -6.3394,-19.44091 2.1131,-7.18468 8.8752,-13.31279 15.2146,-16.05988 6.3394,-2.95839 12.6788,-2.32445 19.0183,-1.90183 m 7.6073,105.02317 c 0.4226,0.42263 0.6339,0.63395 1.6905,-9.08651 0.8453,-9.93177 2.5358,-29.7953 5.0716,-46.0665 a 99.740309,99.740309 0 0 1 11.4109,-36.97998 c 5.2829,-8.45257 12.6788,-13.10148 21.1314,-12.67886 8.2413,0.21131 17.5391,5.28285 21.1315,12.04491 3.5923,6.76205 1.6905,14.792 -3.8037,20.28617 a 28.10479,28.10479 0 0 1 -21.1314,6.76205 c -6.9733,-0.63394 -12.2562,-4.22629 -17.5391,-7.60731 m 134.3959,6.76205 c -6.3395,1.05658 -12.4676,2.11314 -19.0183,0 -6.762,-2.11314 -13.9468,-7.60731 -16.9051,-14.58067 -2.9585,-6.76206 -1.4793,-15.21463 4.2262,-19.86354 6.3394,-4.86023 16.9051,-5.91681 24.5125,-2.95841 7.8186,3.16972 12.6789,10.14309 14.3694,20.07485 1.6905,9.93178 0,22.82194 -2.1132,39.72708 -1.9018,17.11645 -4.2263,38.6705 -10.777,46.91176 -6.7621,8.45256 -17.7505,3.59234 -24.9351,-3.16972 a 59.16798,59.16798 0 0 1 -13.5241,-24.30113 m -19.6522,-76.70706 a 28.950047,28.950047 0 0 0 -16.4826,15.84856 c -2.5357,6.97338 0,14.792 7.1847,18.17303 7.3961,3.59234 19.8636,2.74709 25.3577,-3.38103 5.2829,-6.33943 3.5924,-17.96171 0,-24.72377 -3.8036,-6.55073 -9.5091,-8.45257 -16.0598,-5.91679 z m 84.5257,-1.69052 c 0,7.18469 -0.4227,14.36937 0.8452,21.13143 1.0566,6.97337 3.5923,13.31279 8.6638,15.84856 5.283,2.74708 13.1015,1.69051 18.5957,-1.90182 5.4942,-3.38103 8.6639,-9.50914 10.3544,-15.63726 1.4792,-6.33943 1.4792,-12.46754 1.4792,-18.80696 m 16.9052,19.65221 c 7.3959,1.05658 15.2146,2.11315 21.554,0 6.3394,-2.11313 10.9883,-7.6073 9.2978,-13.10147 -1.6905,-5.49417 -9.9318,-10.98835 -17.539,-11.19966 a 19.01828,19.01828 0 0 0 -17.9618,12.25623 c -3.1697,7.60731 -2.5357,17.75039 1.9019,23.24456 4.2263,5.49417 12.2562,6.33943 19.8635,6.33943 7.396,0 14.3694,-1.4792 21.554,-2.95841"></path>
    <a xlink:href="/">
      <rect fill="transparent" x="2050" y="50" height="200" width="400"></rect>
    </a>
  </svg>
</header>


    <main>
      <h1 id="article-title" itemprop="headline">cordova-plugin-webp: WebP support for iOS</h1>
      <article aria-labelledby="article-title" itemprop="articleBody"><div><small>Posted on <time pubdate datetime="2014-11-24">November 24<sup>th</sup>, 2014</time></small></div>

<blockquote>
<p><strong>Note:</strong> The plugin described in this post is deprecated due to lack of compatibility with <code>WKWebView</code> webviews on iOS, which are now required to be used by Apple.</p>
</blockquote>
<p>Google&#39;s WebP image format can produce some significant savings in image file sizes, particularly for images with transparency that previously required <abbr>PNG</abbr>.  WebP is supported natively in Google Chrome, and on Android 4.0 and higher (although 4.0 and 4.1 had some limitations).</p>
<p>On mobile, the smaller file sizes mean less network bandwidth and faster image loading.  Several mobile websites are already using device detection to serve WebP images to supported browsers.  For hybrid apps, using WebP for assets means the application bundle is smaller.</p>
<p>Unfortunately, iOS doesn&#39;t support WebP images.</p>
<h2 id="getting-webp-working-on-ios">Getting WebP working on iOS</h2>
<p>It&#39;s relatively easy to compile the WebP library for iOS and bundle it with your application.  Carson McDonald has <a href="https://github.com/carsonmcdonald/WebP-iOS-example">a script on GitHub</a> to compile libwebp for iOS and generate a WebP.framework file, as well as a <a href="http://www.ioncannon.net/programming/1483/using-webp-to-reduce-native-ios-app-size/">blog post</a> detailing how to use libwebp from Objective C.</p>
<p>Using Objective C, you can feed a WebP image to the decoder and then feed the decoded image data into a <code>UIImage</code>.  That works reasonably well for native apps written entirely in Objective C, but doesn&#39;t work for apps that are trying to display WebP images in a web view.</p>
<p>Luckily, iOS provides a way of registering <abbr>URL</abbr> interceptors.  These are most commonly used to implement custom <abbr>URL</abbr> protocols, but they can also be used to intercept requests based on a particular file extension.</p>
<p>Scott Talbot proved it was possible to use a <abbr>URL</abbr> interceptor to decode WebP images for web views with his <a href="https://github.com/cysp/STWebPDecoder">STWebPDecoder project</a>.  He wrote a WebP decoder based on libwebp and an interceptor that will decode WebP images before feeding them back to the web view.</p>
<h2 id="automatic-webp-support-for-cordova">Automatic WebP support for Cordova</h2>
<p>Based on Scott Talbot&#39;s <abbr>URL</abbr> interceptor and decoder and using Carson McDonald&#39;s script to build WebP.framework, I&#39;ve put together a plugin for Apache Cordova that will automatically and transparently support WebP images in iOS <code>UIWebView</code>.</p>
<p>The plugin source code is available at <a href="https://github.com/dpogue/cordova-plugin-webp">https://github.com/dpogue/cordova-plugin-webp</a></p>
<p>You can add the plugin to your Cordova project using the command-line tools:<br><code>cordova plugin add cordova-plugin-webp</code></p>
<p>Currently it uses libwebp 0.4.2, and has been tested and verified to work with a <code>UIWebView</code>.  It has not been tested with <code>WkWebView</code> on iOS 8.  If you find bugs, please report them <a href="https://github.com/dpogue/cordova-plugin-webp/issues/">on GitHub</a>.</p>
</article>
    </main>
  </body>
</html>
